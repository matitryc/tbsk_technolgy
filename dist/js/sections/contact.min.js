"use strict";emailjs.init("Hhpvi3dgfNV-eaXKW");var btn=document.querySelector(".buttoners"),cross=document.querySelector(".cross"),formBox=document.querySelector(".form-box"),notifications=document.querySelector(".notifications"),notificationMessages={cooldown:'Błąd podczas wysyłania maila.<br>Osiągnięto limit maili wynoszący: <span class="highlight">3</span>.<br>Spróbuj 24h po wysłaniu ostatniego maila.',error:"Błąd podczas wysyłania maila.<br>Spróbuj ponownie później.",success:' E-mail pomyślnie wysłano.<br>Liczba maili możliwych do wysłania<br>w ciągu następnych 24h: <span class="highlight"></span>.'},opennedForm=formBox.querySelector(".open-form-inner"),form=document.querySelector(".contact form"),formTelephoneControls=document.querySelectorAll(".form-controls"),numbers="0123456789",disableScroll=function(){var e=window.scrollY;window.onscroll=function(){window.scrollTo({top:e,behavior:"instant"})}},handleArrowRight=function(e){e=e.nextElementSibling;e&&e.focus()},handleArrowLeft=function(e){e=e.previousElementSibling;e&&e.focus()},handleInput=function(e,t){"Backspace"==e?""==t.value?handleArrowLeft(t):t.value="":""!=t.value&&handleArrowRight(t)},enableScroll=function(){window.onscroll=function(){}},closeFormIfOutside=function(e){opennedForm.contains(e.target)||e.target==btn||(formBox.setAttribute("aria-hidden","true"),enableScroll())},resetForm=function(){var e=form.querySelectorAll("input"),t=form.querySelector("textarea");e.forEach(function(e){e.value=""}),t.value=""},createNotification=function(e,t){var o=document.createElement("div"),e=(o.setAttribute("data-success",e),document.createElement("p"));e.innerHTML=t,o.append(e),t==notificationMessages.success&&(t=3-+document.cookie.split(";").find(function(e){return e.trim().startsWith("limit")}).split("=")[1],e.querySelector(".highlight").append(t)),o.classList.add("notification"),notifications.append(o),setTimeout(function(){o.classList.add("shown"),setTimeout(function(){o.classList.remove("shown"),setTimeout(function(){o.remove()},500)},5e3)},100)};btn.addEventListener("click",function(){disableScroll(),formBox.setAttribute("aria-hidden","false")}),cross.addEventListener("click",function(){enableScroll(),formBox.setAttribute("aria-hidden","true")}),formTelephoneControls.forEach(function(t){t.addEventListener("keydown",function(e){"ArrowRight"==e.key?handleArrowRight(t):"ArrowLeft"==e.key?handleArrowLeft(t):handleInput(e.key,t)}),t.addEventListener("input",function(e){numbers.includes(e.target.value)||(e.target.value="")})}),form.addEventListener("submit",function(e){e.preventDefault();var o,e=document.cookie.split(";");e.find(function(e){return e.trim().startsWith("emailCooldown")})?(formBox.classList.add("hidden"),enableScroll(),createNotification("false",notificationMessages.cooldown)):(e=e.find(function(e){return e.trim().startsWith("limit")}),3<=(o=e?+e.split("=")[1]:0)?((e=new Date).setTime(e.getTime()+72e5),document.cookie="emailCooldown = emailCooldown; expires =  ".concat(e),document.cookie="limit=3; expires = ".concat(e),resetForm(),formBox.setAttribute("aria-hidden","true"),enableScroll(),createNotification("false",notificationMessages.cooldown)):emailjs.sendForm("service_pk7b8o3","template_ykytfdk",form).then(function(){var e,t;formBox.setAttribute("aria-hidden","true"),enableScroll(),resetForm(),e=++o,(t=new Date).setTime(t.getTime()+864e5),document.cookie="limit=".concat(e,"; expires = ").concat(t),createNotification("true",notificationMessages.success)}).catch(function(){createNotification("false",notificationMessages.error)}))}),window.addEventListener("click",function(e){return closeFormIfOutside(e)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlY3Rpb25zL2NvbnRhY3QuanMiXSwibmFtZXMiOlsiZW1haWxqcyIsImluaXQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJidG4iLCJjcm9zcyIsImZvcm1Cb3giLCJub3RpZmljYXRpb25zIiwiY29vbGRvd24iLCJub3RpZmljYXRpb25NZXNzYWdlcyIsImVycm9yIiwib3Blbm5lZEZvcm0iLCJmb3JtIiwicXVlcnlTZWxlY3RvckFsbCIsIm51bWJlcnMiLCJkaXNhYmxlU2Nyb2xsIiwic2Nyb2xsVG9wIiwid2luZG93Iiwic2Nyb2xsWSIsIm9uc2Nyb2xsIiwic2Nyb2xsVG8iLCJ0b3AiLCJiZWhhdmlvciIsIm5leHRDb250cm9sIiwiY29udHJvbCIsIm5leHRFbGVtZW50U2libGluZyIsImZvY3VzIiwicHJldkNvbnRyb2wiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiaGFuZGxlQXJyb3dMZWZ0Iiwia2V5IiwidmFsdWUiLCJoYW5kbGVBcnJvd1JpZ2h0IiwiZW5hYmxlU2Nyb2xsIiwiaW5wdXRzIiwidGV4dGFyZWEiLCJlIiwidGFyZ2V0IiwiZm9yRWFjaCIsImlucHV0IiwiY3JlYXRlTm90aWZpY2F0aW9uIiwibm90aWZpY2F0aW9uIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImlzU3VjY2VzcyIsImlubmVySFRNTCIsIm1lc3NhZ2UiLCJzdGFydHNXaXRoIiwiaGlnaGxpZ2h0U3BhbiIsImxpbWl0VmFsdWUiLCJsaW1pdENvb2tpZSIsImFwcGVuZCIsInAiLCJjbGFzc0xpc3QiLCJzdWNjZXNzIiwiYWRkIiwic3BsaXQiLCJmaW5kIiwiY29va2llIiwidHJpbSIsInJlbW92ZSIsInNldFRpbWVvdXQiLCJhZGRFdmVudExpc3RlbmVyIiwiZm9ybVRlbGVwaG9uZUNvbnRyb2xzIiwiaW5jbHVkZXMiLCJwcmV2ZW50RGVmYXVsdCIsImRhdGUiLCJnZXRUaW1lIiwiZGF5IiwicmVzZXRGb3JtIiwiY29va2llcyIsIkRhdGUiLCJjb250YWN0U2VydmljZUlkIiwiY29udGFjdEZvcm1JZCIsImNvbmNhdCIsInNlbmRGb3JtIiwidGhlbiIsInNldFRpbWUiLCJjbG9zZUZvcm1JZk91dHNpZGUiXSwibWFwcGluZ3MiOiJhQUNBQSxRQUFRQyxLQUFLLG1CQUFtQixFQUFoQ0QsSUFBQUEsSUFBWUUsU0FBQ0MsY0FBb0IsWUFBQSxFQUUzQkMsTUFBTUYsU0FBU0MsY0FBYyxRQUFZLEVBQ3pDRSxRQUFRSCxTQUFTQyxjQUFjLFdBQVMsRUFDeENHLGNBQWtCSixTQUFDQyxjQUFjLGdCQUFZLEVBQzdDSSxxQkFBeUJKLENBQy9CSyxTQUFNQyxvSkFDSkQsTUFBQUEsNkRBQ0FFLFFBQU8sOEhBRVQsRUFBQ0MsWUFBQUwsUUFBQUgsY0FBQSxrQkFBQSxFQUNLUSxLQUFBQSxTQUFjTCxjQUFRSCxlQUFjLEVBQ3BDUyxzQkFBZ0JULFNBQWNVLGlCQUFnQixnQkFBQSxFQUc5Q0MsUUFBVSxhQUNWQyxjQUFnQixXQUNwQixJQUFNQyxFQUFZQyxPQUFPQyxRQUN6QkQsT0FBT0UsU0FBVyxXQUNoQkYsT0FBT0csU0FBUyxDQUNkQyxJQUFLTCxFQUNMTSxTQUFVLFNBQ1osQ0FBQyxDQUNILENBQ0YsRUFHUUMsaUJBQWNDLFNBQUFBLEdBQ2pCRCxFQUFZQyxFQUFBQyxtQkFDYkYsR0FDRkEsRUFBQUcsTUFBQSxDQUdGLEVBRUtDLGdCQUFZLFNBQUFILEdBQ2JHLEVBQWtCSCxFQUFDSSx1QkFDckJELEdBQ0RBLEVBQUFELE1BQUEsQ0FBRCxFQUtNRyxZQUFBQSxTQUFlQyxFQUFDTixHQUViLGFBREpNLEVBRW1CLElBQWxCTixFQUFRTyxNQUNWRixnQkFBQUwsQ0FBQSxFQUlFUSxFQUFBQSxNQUFnQixHQUtELElBQWZDLEVBQUFBLE9BQ0poQixpQkFBa0JPLENBQUEsQ0FIcEIsRUFTSVMsYUFBYyxXQUNoQmhCLE9BQUFFLFNBQUEsWUFDRixFQUdRZSxtQkFBY3JCLFNBQUFBLEdBQ2RzQixZQUFXdkIsU0FBS1QsRUFBQUEsTUFBYSxHQUFDaUMsRUFBQUMsUUFBV2pDLE1BQy9DOEIsUUFBT0ksYUFBUSxjQUFTLE1BQUEsRUFDdEJDLGFBQVcsRUFOZixFQVdNQyxVQUFBQSxXQUNKLElBQU1DLEVBQUFBLEtBQWV2QyxpQkFBU3dDLE9BQWMsRUFDNUNELEVBQWFFLEtBQUFBLGNBQWEsVUFBZ0JDLEVBQ3hDVixFQUFPSSxRQUFHcEMsU0FBQUEsR0FDUjJDLEVBQUFBLE1BQVlDLEVBQ2RMLENBQUFBLEVBQ0FOLEVBQUdXLE1BQVdyQyxFQVJsQixFQVU2QytCLG1CQUFrQk8sU0FBQUEsRUFBV0QsR0FQeEUsSUFPaUZMLEVBQUF2QyxTQUFBd0MsY0FBQSxLQUFBLEVBRXZFTSxHQVJWUCxFQU9VUSxhQUFrQkMsZUFBa0JOLENBQU8sRUFDM0NJLFNBQWFOLGNBQUt2QyxHQUFjLEdBQ3RDNkMsRUFBQUEsVUFBY0csRUFDaEJWLEVBQUFVLE9BQUFDLENBQUEsRUFDRlgsR0FBYVkscUJBQWNDLFVBR3pCYixFQUFhWSxFQUFVRSxDQUZMckQsU0FBQ3VDLE9BQWFlLE1BQUEsR0FBQSxFQUNqQkMsS0FBQSxTQUFBQyxHQUFBLE9BQUFBLEVBQUFDLEtBQUEsRUFBQVosV0FBQSxPQUFBLENBQUEsQ0FBQSxFQUNvQlMsTUFBQSxHQUFBLEVBQUEsR0FDbEJKLEVBQUFqRCxjQUFBLFlBQUEsRUFDRmtELE9BQUFBLENBQWlCLEdBTGxDWixFQU9NQSxVQUFhbUIsSUFBUSxjQUFBLEVBTjNCckQsY0FPVzRDLE9BQUFWLENBQUEsRUFOWG9CLFdBT1UsV0FDVHBCLEVBQU1ZLFVBQUFFLElBQUEsT0FBQSxFQUNSTSxXQUFBLFdBRUdDLEVBQUFBLFVBQXdCRixPQUFFLE9BQVksRUFDeEM3QyxXQUFlLFdBQ2hCVCxFQUFRcUMsT0FBYSxDQUNwQixFQUFBLEdBQUEsQ0FDRnRDLEVBQU15RCxHQUFBQSxDQUNKN0IsRUFBQUEsR0FBQUEsQ0FQRixFQVVBOEIsSUFBQUEsaUJBQXFCLFFBQVMsV0FDNUJ2QyxjQUFRc0MsRUFQVHhELFFBUU9xQyxhQUFRLGNBQWEsT0FBQSxDQVA3QixDQUFDLEVBQ0R0QyxNQVFLeUQsaUJBQ1ksUUFBSSxXQVJuQjdCLGFBU0lKLEVBUkx2QixRQVNJcUMsYUFDSSxjQUFBLE1BQUEsQ0FUVCxDQUFDLEVBQ0RvQixzQkFVSXpCLFFBQUEsU0FBQWQsR0FDRkEsRUFBRXNDLGlCQUFBLFVBQUEsU0FBQTFCLEdBQ00wQixjQUFSdEMsRUFBT00sSUFDTEUsaUJBQVlnQyxDQUFXM0IsRUFFdkIsYUFBQUQsRUFBQU4sSUFDQUQsZ0JBQUFMLENBQUEsRUFHQXlDLFlBQWM3QixFQUFFTixJQUFBTixDQUFBLENBUmxCLENBQUMsRUFDREEsRUFVUTBDLGlCQUFpQixRQUFBLFNBQUE5QixHQUNuQnRCLFFBQVFrRCxTQUFNRyxFQUFBQSxPQUFZQyxLQUFJLElBQ2xDbEUsRUFBQUEsT0FBU3dELE1BQU0sR0FHakIsQ0FBQSxDQVZGLENBQUMsRUFDRDlDLEtBVTRDa0QsaUJBQWUsU0FBR2YsU0FBQUEsR0FBMkJYLEVBQUM2QixlQUFBLEVBQ3hGLElBZUlJLEVBVkRDLEVBQ0lwRSxTQUFBd0QsT0FBQUYsTUFBQSxHQUFBLEVBQ1dOLEVBQVlNLEtBQU0sU0FBQUUsR0FBTSxPQUFDQSxFQUFBQyxLQUFBLEVBQUFaLFdBQUEsZUFBQSxDQUFBLENBQUEsR0ErQnpDekMsUUFBUStDLFVBQVVFLElBQUksUUFBUSxFQUM5QnRCLGFBQWEsRUFDYk8sbUJBQW1CLFFBQVMvQixxQkFBcUJELFFBQVEsSUEvQnREeUMsRUFBY3FCLEVBQUViLEtBQUEsU0FBQUMsR0FBQSxPQUFBQSxFQUFBQyxLQUFBLEVBQUFaLFdBQUEsT0FBQSxDQUFBLENBQUEsRUFRSCxJQUZkc0IsRUFKQW5CLEVBSVcsQ0FBQUEsRUFBQU0sTUFBQSxHQUFBLEVBQUEsR0FIRVUsS0FRVkEsRUFBQSxJQUFBSyxNQUNHQyxRQUFBQSxFQUFBQSxRQUFtQixFQUh6QmhDLElBR3lCLEVBQ3pCdEMsU0FBTXVFLE9BQUFBLDZDQUFBQSxPQUFrQ1AsQ0FBQSxFQUN4Q2hFLFNBQUF3RCxPQUFBLHNCQUFBZ0IsT0FBQVIsQ0FBQSxFQUNBbEUsVUFBUTJFLEVBUlJyRSxRQVVFQSxhQUFRcUMsY0FBMEIsTUFBRSxFQVR0Q1YsYUFVRUEsRUFURk8sbUJBVWEsUUFBQS9CLHFCQUFBRCxRQUFBLEdBT2ZSLFFBQUEyRSxTQUhlLGtCQUNRLG1CQUV2Qi9ELElBQUEsRUFDRGdFLEtBQ0ksV0FyQ2MsSUFBQTdDLEVBQ29CbUMsRUFxQ3JDNUQsUUFBUStDLGFBQWMsY0FBUyxNQUFBLEVBQy9CcEIsYUFBYyxFQUNkTyxVQUFBQSxFQXhDaUJULEVBeUNuQixFQUFBa0IsR0F4Q3VDaUIsRUFBSVIsSUFBT0MsTUFBMkJrQixRQUFBWCxFQUFBQyxRQUFBLEVBQXZFakIsS0FBdUUsRUFDM0VoRCxTQUFJK0MsT0FBVSxTQUFBeUIsT0FBQTNDLEVBQUEsY0FBQSxFQUFBMkMsT0FBQVIsQ0FBQSxFQXdDaEIxQixtQkFBQSxPQUFBL0IscUJBQUE2QyxPQUFBLENBRUksQ0FBQ1EsRUFBQUEsTUFBaUNnQixXQUFzQnRDLG1CQUFBLFFBQUEvQixxQkFBQUMsS0FBQSxDQVZ4RCxDQUFDLEVBUVAsQ0FBQyxFQUVETyxPQUFPNkMsaUJBQWlCLFFBQVMsU0FBQzFCLEdBQUMsT0FBSzBDLG1CQUFtQjFDLENBQUMsQ0FBQyxDQUFBIiwiZmlsZSI6InNlY3Rpb25zL2NvbnRhY3QubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG5lbWFpbGpzLmluaXQoJ0hocHZpM2RnZk5WLWVhWEtXJylcblxuY29uc3QgYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1dHRvbmVycycpXG5jb25zdCBjcm9zcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcm9zcycpXG5jb25zdCBmb3JtQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tYm94JylcbmNvbnN0IG5vdGlmaWNhdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90aWZpY2F0aW9ucycpXG5jb25zdCBub3RpZmljYXRpb25NZXNzYWdlcyA9IHtcbiAgY29vbGRvd246ICdCxYLEhWQgcG9kY3phcyB3eXN5xYJhbmlhIG1haWxhLjxicj5Pc2nEhWduacSZdG8gbGltaXQgbWFpbGkgd3lub3N6xIVjeTogPHNwYW4gY2xhc3M9XCJoaWdobGlnaHRcIj4zPC9zcGFuPi48YnI+U3Byw7NidWogMjRoIHBvIHd5c8WCYW5pdSBvc3RhdG5pZWdvIG1haWxhLicsXG4gIGVycm9yOiAnQsWCxIVkIHBvZGN6YXMgd3lzecWCYW5pYSBtYWlsYS48YnI+U3Byw7NidWogcG9ub3duaWUgcMOzxbpuaWVqLicsXG4gIHN1Y2Nlc3M6ICcgRS1tYWlsIHBvbXnFm2xuaWUgd3lzxYJhbm8uPGJyPkxpY3piYSBtYWlsaSBtb8W8bGl3eWNoIGRvIHd5c8WCYW5pYTxicj53IGNpxIVndSBuYXN0xJlwbnljaCAyNGg6IDxzcGFuIGNsYXNzPVwiaGlnaGxpZ2h0XCI+PC9zcGFuPi4nXG59XG5jb25zdCBvcGVubmVkRm9ybSA9IGZvcm1Cb3gucXVlcnlTZWxlY3RvcignLm9wZW4tZm9ybS1pbm5lcicpXG5jb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3QgZm9ybScpXG5jb25zdCBmb3JtVGVsZXBob25lQ29udHJvbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jb250cm9scycpXG5cbmNvbnN0IG51bWJlcnMgPSAnMDEyMzQ1Njc4OSdcbmNvbnN0IGRpc2FibGVTY3JvbGwgPSAoKSA9PiB7XG4gIGNvbnN0IHNjcm9sbFRvcCA9IHdpbmRvdy5zY3JvbGxZXG4gIHdpbmRvdy5vbnNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB3aW5kb3cuc2Nyb2xsVG8oe1xuICAgICAgdG9wOiBzY3JvbGxUb3AsXG4gICAgICBiZWhhdmlvcjogJ2luc3RhbnQnLFxuICAgIH0pXG4gIH1cbn1cblxuY29uc3QgaGFuZGxlQXJyb3dSaWdodCA9IChjb250cm9sKSA9PiB7XG4gIGNvbnN0IG5leHRDb250cm9sID0gY29udHJvbC5uZXh0RWxlbWVudFNpYmxpbmdcbiAgaWYobmV4dENvbnRyb2wpe1xuICAgIG5leHRDb250cm9sLmZvY3VzKClcbiAgfVxufVxuXG5jb25zdCBoYW5kbGVBcnJvd0xlZnQgPSAoY29udHJvbCkgPT4ge1xuICBjb25zdCBwcmV2Q29udHJvbCA9IGNvbnRyb2wucHJldmlvdXNFbGVtZW50U2libGluZ1xuICBpZihwcmV2Q29udHJvbCl7XG4gICAgcHJldkNvbnRyb2wuZm9jdXMoKVxuICB9XG59XG5cbmNvbnN0IGhhbmRsZUlucHV0ID0gKGtleSwgY29udHJvbCkgPT4ge1xuICBpZihrZXkgPT0gJ0JhY2tzcGFjZScpIHtcbiAgICBpZihjb250cm9sLnZhbHVlID09ICcnKXtcbiAgICAgIGhhbmRsZUFycm93TGVmdChjb250cm9sKVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGNvbnRyb2wudmFsdWUgPSAnJ1xuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICBpZihjb250cm9sLnZhbHVlICE9ICcnKXtcbiAgICAgIGhhbmRsZUFycm93UmlnaHQoY29udHJvbClcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgZW5hYmxlU2Nyb2xsID0gKCkgPT4ge1xuICB3aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbiAoKSB7fVxufVxuXG5jb25zdCBjbG9zZUZvcm1JZk91dHNpZGUgPSAoZSkgPT4ge1xuICBpZighb3Blbm5lZEZvcm0uY29udGFpbnMoZS50YXJnZXQpICYmIGUudGFyZ2V0ICE9IGJ0bil7XG4gICAgZm9ybUJveC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKVxuICAgIGVuYWJsZVNjcm9sbCgpXG4gIH1cbn1cblxuY29uc3QgcmVzZXRGb3JtID0gKCkgPT4ge1xuICBjb25zdCBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JylcbiAgY29uc3QgdGV4dGFyZWEgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJylcbiAgaW5wdXRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgIGlucHV0LnZhbHVlID0gJydcbiAgfSlcbiAgdGV4dGFyZWEudmFsdWUgPSAnJ1xufVxuXG5jb25zdCBjcmVhdGVOb3RpZmljYXRpb24gPSAoaXNTdWNjZXNzLCBtZXNzYWdlKSA9PiB7XG4gIGNvbnN0IG5vdGlmaWNhdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gIG5vdGlmaWNhdGlvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3VjY2VzcycsIGlzU3VjY2VzcylcbiAgICBjb25zdCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpXG4gICAgcC5pbm5lckhUTUwgPSBtZXNzYWdlXG4gICAgbm90aWZpY2F0aW9uLmFwcGVuZChwKVxuICAgIGlmKG1lc3NhZ2UgPT0gbm90aWZpY2F0aW9uTWVzc2FnZXMuc3VjY2Vzcyl7XG4gICAgICBjb25zdCBjb29raWVzID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7JylcbiAgICAgIGNvbnN0IGxpbWl0Q29va2llID0gY29va2llcy5maW5kKGNvb2tpZSA9PiBjb29raWUudHJpbSgpLnN0YXJ0c1dpdGgoJ2xpbWl0JykpXG4gICAgICBjb25zdCBsaW1pdFZhbHVlID0gMyAtICtsaW1pdENvb2tpZS5zcGxpdCgnPScpWzFdXG4gICAgICBjb25zdCBoaWdobGlnaHRTcGFuID0gcC5xdWVyeVNlbGVjdG9yKCcuaGlnaGxpZ2h0JylcbiAgICAgIGhpZ2hsaWdodFNwYW4uYXBwZW5kKGxpbWl0VmFsdWUpXG4gICAgfVxuICBub3RpZmljYXRpb24uY2xhc3NMaXN0LmFkZCgnbm90aWZpY2F0aW9uJylcbiAgbm90aWZpY2F0aW9ucy5hcHBlbmQobm90aWZpY2F0aW9uKVxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBub3RpZmljYXRpb24uY2xhc3NMaXN0LmFkZCgnc2hvd24nKVxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgbm90aWZpY2F0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3duJylcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBub3RpZmljYXRpb24ucmVtb3ZlKClcbiAgICAgIH0sIDUwMClcbiAgICB9LCA1MDAwKVxuICB9LCAxMDApXG59XG5cbmJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgZGlzYWJsZVNjcm9sbCgpXG5cdGZvcm1Cb3guc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpXG59KVxuY3Jvc3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gIGVuYWJsZVNjcm9sbCgpXG5cdGZvcm1Cb3guc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJylcbn0pXG5mb3JtVGVsZXBob25lQ29udHJvbHMuZm9yRWFjaChjb250cm9sID0+IHtcbiAgY29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICBpZihlLmtleSA9PSAnQXJyb3dSaWdodCcpe1xuICAgICAgaGFuZGxlQXJyb3dSaWdodChjb250cm9sKVxuICAgIH1cbiAgICBlbHNlIGlmKGUua2V5ID09ICdBcnJvd0xlZnQnKXtcbiAgICAgIGhhbmRsZUFycm93TGVmdChjb250cm9sKVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGhhbmRsZUlucHV0KGUua2V5LCBjb250cm9sKVxuICAgIH1cbiAgfSlcbiAgY29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7XG4gICAgaWYoIW51bWJlcnMuaW5jbHVkZXMoZS50YXJnZXQudmFsdWUpKXtcbiAgICAgIGUudGFyZ2V0LnZhbHVlID0gJydcbiAgICB9XG4gIH0pXG59KVxuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KClcbiAgY29uc3Qgc2V0U2VuZExpbWl0ID0gKHZhbHVlKSA9PiB7XG4gICAgY29uc3QgZGF5ID0gMjQgKiA2MCAqIDYwICogMTAwMFxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpXG4gICAgZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpICsgZGF5KVxuICAgIGRvY3VtZW50LmNvb2tpZSA9IGBsaW1pdD0ke3ZhbHVlfTsgZXhwaXJlcyA9ICR7ZGF0ZX1gXG4gIH1cbiAgXG4gIGNvbnN0IGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKVxuICBjb25zdCBjb29sZG93bkNvb2tpZSA9IGNvb2tpZXMuZmluZChjb29raWUgPT4gY29va2llLnRyaW0oKS5zdGFydHNXaXRoKCdlbWFpbENvb2xkb3duJykpXG4gIGlmKCFjb29sZG93bkNvb2tpZSl7XG4gICAgbGV0IGxpbWl0Q29va2llID0gY29va2llcy5maW5kKGNvb2tpZSA9PiBjb29raWUudHJpbSgpLnN0YXJ0c1dpdGgoJ2xpbWl0JykpXG4gICAgbGV0IGxpbWl0VmFsdWVcbiAgICBpZighbGltaXRDb29raWUpe1xuICAgICAgbGltaXRWYWx1ZSA9IDBcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBsaW1pdFZhbHVlID0gK2xpbWl0Q29va2llLnNwbGl0KCc9JylbMV1cbiAgICB9XG4gICAgaWYobGltaXRWYWx1ZSA+PSAzKXtcbiAgICAgIGNvbnN0IHR3b0hvdXJzID0gMTIwICogNjAgKiAxMDAwXG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKVxuICAgICAgZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpICsgdHdvSG91cnMpXG4gICAgICBkb2N1bWVudC5jb29raWUgPSBgZW1haWxDb29sZG93biA9IGVtYWlsQ29vbGRvd247IGV4cGlyZXMgPSAgJHtkYXRlfWBcbiAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGBsaW1pdD0zOyBleHBpcmVzID0gJHtkYXRlfWBcbiAgICAgIHJlc2V0Rm9ybSgpXG4gICAgICBmb3JtQm94LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpXG4gICAgICBlbmFibGVTY3JvbGwoKVxuICAgICAgY3JlYXRlTm90aWZpY2F0aW9uKCdmYWxzZScsIG5vdGlmaWNhdGlvbk1lc3NhZ2VzLmNvb2xkb3duKVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGNvbnN0IGNvbnRhY3RTZXJ2aWNlSWQgPSAnc2VydmljZV9wazdiOG8zJ1xuICAgICAgY29uc3QgY29udGFjdEZvcm1JZCA9ICd0ZW1wbGF0ZV95a3l0ZmRrJ1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gICAgICBlbWFpbGpzLnNlbmRGb3JtKGNvbnRhY3RTZXJ2aWNlSWQsIGNvbnRhY3RGb3JtSWQsIGZvcm0pXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGZvcm1Cb3guc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJylcbiAgICAgICAgZW5hYmxlU2Nyb2xsKClcbiAgICAgICAgcmVzZXRGb3JtKClcbiAgICAgICAgc2V0U2VuZExpbWl0KCsrbGltaXRWYWx1ZSlcbiAgICAgICAgY3JlYXRlTm90aWZpY2F0aW9uKCd0cnVlJywgbm90aWZpY2F0aW9uTWVzc2FnZXMuc3VjY2VzcylcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICBjcmVhdGVOb3RpZmljYXRpb24oJ2ZhbHNlJywgbm90aWZpY2F0aW9uTWVzc2FnZXMuZXJyb3IpXG4gICAgICB9KVxuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICBmb3JtQm94LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpXG4gICAgZW5hYmxlU2Nyb2xsKClcbiAgICBjcmVhdGVOb3RpZmljYXRpb24oJ2ZhbHNlJywgbm90aWZpY2F0aW9uTWVzc2FnZXMuY29vbGRvd24pXG4gIH1cbn0pXG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiBjbG9zZUZvcm1JZk91dHNpZGUoZSkpXG5cblxuIl19
